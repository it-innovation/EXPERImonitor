<!DOCTYPE html>
<html>
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <script src="http://d3js.org/d3.v3.min.js"></script>
        <script src="js/libs/nvd3/nv.d3.js"></script>
        <script src="bower_components/jquery/dist/jquery.min.js"></script>
        <link rel="stylesheet" href="stylesheets/nv.d3.css">
        <style>
            svg {
              height: 400px;
            }
            #chart .nv-stackedAreaChart circle.nv-point
            {
                fill-opacity: 1;
                fill: "black";
            }
        </style>
    </head>    
    <body>
<!--        <div id="chart">
            <svg></svg>
        </div>-->
        <div id="chart1">
            <svg></svg>
        </div>
        <script type="text/javascript">
//        nv.addGraph(function() {
//        var data = [
//            {
//                key: "Group 1", 
//                values: [
//                    {x:1, y:2, size:1},
//                    {x:2, y:2, size:5},
//                    {x:3, y:2, size:5},
//                    {x:4, y:2, size:5},
//                    {x:6, y:2, size:5}
//                ]
//            } 
//        ];
//        var myColors = ["#000"];
//        var chart = nv.models.scatterChart()
//            .showDistX(true)
//            .showDistY(true)
//            .transitionDuration(350)
//            .showLegend(false)
//            .showXAxis(false)
//            .showYAxis(false)
//            .color(d3.scale.ordinal().range(myColors));
//        chart.scatter.onlyCircles(true);
//        d3.select('#chart svg')
//            .datum(data)
//            .call(chart);
//        nv.utils.windowResize(chart.update);
//        return chart;
//    });
//    
//            // line chart
//            d3.json('json/qos.json', function(data) {
//                nv.addGraph(function() {
//                    var chart = nv.models.stackedAreaChart()
//                        .x(function(d) { return d[0]; })
//                        .y(function(d) { return d[1]; })
//                        .clipEdge(true)
//                        .useInteractiveGuideline(true);
//                    chart.xAxis
//                        .showMaxMin(false)
//                        .tickFormat(function(d) { return d3.time.format('%x')(new Date(d)); });
//                    chart.yAxis
//                        .tickFormat(d3.format(',.2f'));
//                    d3.select('#chart svg')
//                        .datum(data)
//                        .transition().duration(500)
//                        .call(chart);
//                    nv.utils.windowResize(chart.update);
//                    return chart;
//                });
//            });
//            var qos = [5, 7, 11];
//            setTimeout( function() { 
//                $('#chart .nv-stackedAreaChart circle.nv-point').attr("r", "0");
//                $.each(qos, function( index, value ) {
//                    $('#chart .nv-stackedAreaChart circle.nv-point.nv-point-' + value).attr("r", "5");
//                    $('#chart .nv-stackedAreaChart circle.nv-point.nv-point-' + value).attr("style", "fill: rgb(0,0,0);");
//                });
//            }, 500 );
            
//  var data1 = dummyStocks();
//  function dummyStocks() {
//    numPoints = 10;
//    function volatileChart(key,startPrice, volatility, isArea) {
//       var rval = {key: key, values: []};
//       if (isArea) rval.area = true;
//       for(var i = 1; i < numPoints; i++) {
//          rval.values.push({x: i, y: (i > 5 && i < 7) ? null : startPrice});
//          var rnd = Math.random();
//          var changePct = 2 * volatility * rnd;
//          if ( changePct > volatility) {
//             changePct -= (2*volatility);
//          }
//          startPrice = startPrice + startPrice * changePct;
//       }
//       return rval;
//    }
//    var stocks = [];
//    stocks.push(volatileChart("MSFT", 2.5, 0.08, true));
//    stocks.push(volatileChart("IBM ", 2.5, 0.08, true));
//    return stocks;
//}

    d3.json("json/service.json", function(error, data) {
        nv.addGraph(function() {
            var myColors = ["#000"];
            var chart;
            chart = nv.models.lineChart()
                .x(function(d) { return d.x; })
                .useInteractiveGuideline(true)
                .isArea(true)
                //.color(d3.scale.ordinal().range(myColors))
                .forceY([0]);
            var formatter = function(d) {
                var now = (new Date()).getTime() - 86400 * 1000 * 365;
                now = new Date(now + d * 86400 * 1000);
                return d3.time.format('%b %d %Y')(now );
            };
            chart.xAxis
                //.tickFormat(formatter);
                //.showMaxMin(false)
                .tickFormat(function(d) { return d3.time.format('%x')(new Date(d)); });
            chart.yAxis
                .axisLabel('Voltage (v)')
                .tickFormat(d3.format(',.2f'));
                 //console.log(JSON.stringify(data1));
            d3.select('#chart1 svg')
                .datum(data)
                .transition().duration(500)
                .call(chart);
            nv.utils.windowResize(chart.update);
            return chart;
        });
    });           
        </script>
    </body>
</html>
